# 快捷键宏命令软件

**快捷键宏命令软件**（`shortcut_keys`）是一个用于管理和执行快捷键宏命令的工具。通过该软件，用户可以定义一系列快捷键与对应的宏命令，当按下指定的快捷键组合时，软件将自动执行预定义的宏命令。

> 📌 当前版本：`v1.3` ｜ 🆕 [查看更新日志 »](#更新日志)

---

## 使用指南

1. 安装所需python包

2. 在 `settings` 文件夹与 `config.py` 文件内配置自己所需的参数

3. 运行程序或打包为软件

### 运行程序

在项目主目录下打开终端，使用以下命名快速运行程序

```bash
python main.py
```

### 软件打包

在项目主目录下打开终端，使用以下命名快速打包软件（需包含所需python包）

```bash
pyinstaller -F -w -i settings/xey.ico main.py
```

打包成功后，软件位于 `dist/main.exe` 

---

## 功能介绍

### 主窗口功能

主窗口提供以下功能：

- **提交**: 启动工作线程，开始监听快捷键。
- **关闭**: 关闭程序。
- **打开宏命令管理窗口**: 打开一个新窗口用于管理宏命令。
- **插入快捷键**: 打开一个新窗口用于插入新的快捷键组合。
- **删除快捷键**: 删除选中的快捷键。
- **修改快捷键**: 修改选中的快捷键。
- **显示快捷键信息**: 显示选中的快捷键信息。
- **更改启用状态**: 切换选中的快捷键的启用状态。
- **重命名快捷键**: 重命名选中的快捷键。
- **软件自动更新**: 可自动更新到最新版本与版本检查。
- **问题反馈**: 可提供优化建议与反馈软件问题。

### 宏命令管理窗口功能

宏命令管理窗口提供以下功能：

- **插入键盘操作**: 插入一个新的键盘操作。
- **插入鼠标操作**: 插入一个新的鼠标操作。
- **分隔操作**: 插入一个分隔符，用于区分不同的操作。
- **添加延时**: 插入一个自定义延时。
- **删除操作**: 删除选中的操作。
- **删除所有操作**: 删除当前宏命令的所有操作。
- **新建宏命令**: 创建一个新的宏命令。
- **删除宏命令**: 删除选中的宏命令。
- **上移操作**: 将选中的操作上移一位。
- **下移操作**: 将选中的操作下移一位。
- **返回主窗口**: 关闭宏命令管理窗口并返回主窗口。
- **显示宏命令操作**: 显示选中的宏命令的所有操作。
- **重命名宏命令**: 重命名选中的宏命令。

### 快捷键输入窗口功能

快捷键输入窗口提供以下功能：

- **输入快捷键**: 监听键盘输入并显示在输入框中。
- **启用状态**: 设置快捷键是否启用。
- **保存快捷键**: 保存当前输入的快捷键和对应的宏命令。
- **删除输入**: 清空当前输入的快捷键。
- **确认输入**: 提交当前输入的快捷键和对应的宏命令。

---

## 项目结构
```
shortcut_keys/
├── .gitignore
├── README.md
├── config.py  # 配置函数文件，包含配置文件的初始化与配置文件的读取和写入
├── main.py  # 主程序文件
├── main.spec  # 软件打包文件
├── network/
│   ├── __init__.py
│   ├── server_connect.py  # 服务器交互相关函数
│   └── software_update.py  # 软件自动更新相关函数
├── settings/  # 配置文件
│   ├── .linux.toml  # root用户密码与虚拟环境地址(Linux环境下需先配置)
│   ├── .secret.toml  # 存储连接服务器信息
│   ├── keys.json  # 存储快捷键及其对应的宏命令
│   ├── macros.json  # 存储宏命令及其操作
│   └── xey.ico  # 图标
├── system_init.py  # 系统初始化函数文件，包含Linux系统基础化配置
├── thread/
│   ├── __init__.py
│   └── work_thread.py  # 工作线程的实现，用于在后台监听快捷键输入并执行相应的宏命令
├── ui/  # ui界面相关文件
│   ├── __init__.py
│   ├── feedback.py
│   ├── feedback.ui
│   ├── keys_combo.py
│   ├── keys_combo.ui
│   ├── macro_command.py
│   ├── macro_command.ui
│   ├── main/
│   │   ├── __init__.py
│   │   ├── feedback_main.py  # 问题反馈窗口的实现
│   │   ├── keys_insert.py  # 快捷键输入窗口的实现，用户可以在此窗口中添加新的快捷键和对应的宏命令
│   │   ├── macro_manage.py  # 宏命令管理窗口的实现，用户可以在此窗口中添加、删除、修改宏命令
│   │   └── main_window.py  # 主窗口实现，包含主要功能代码
│   ├── shortcut_keys.py
│   └── shortcut_keys.ui
└── utils.py  # 工具函数文件
```

---

## 更新日志

### V1.3

### 2025-05-13

### ✨ 新增功能

1. **增加用户反馈功能**
  - ① 在菜单栏中增加用户反馈功能，用户可选择反馈类型与输入需要反馈的内容，一键提交至服务器后台，反馈文件按类别与时间戳命名
  - ② 自动服务器连接检测：点击反馈功能时会自动检测服务器连接情况
2. **新增宏命令支持功能**
  - ① 新增对鼠标滚轮宏命令支持，用户可添加向上滚动（scroll_up）与向下滚动（scroll_down）

### ⚙️ 功能优化

1. **优化keyboard包BUG解决方案**
  - ① 完全解决BUG问题，无需再次将软件切至前台，新增按键监测机制，在检测到按下win+l锁屏后，进入待清理模式，下次按键实现自动化清理按键表
2. **重构代码结构**
  - ① 拆分服务器交互与软件更新相关函数，归于network文件夹
  - ② 将Gui相关界面与实现功能和拆分主文件相关部分，归于ui文件夹
  - ③ 优化config.py，将全部路径导入配置，默认参数，MAP对应与文件加载等相关函数移到此处
  - ④ 将工作线程归于thread文件夹  

### 📜 完整更新日志

 **点此查看所有历史版本和详细改动说明：**  
🔗[查看完整更新日志 »](CHANGELOG.md)

---

## 贡献

欢迎贡献代码！

## 作者

- **ZhangYuetao** - 项目开发者
- 邮箱: zhang894171707@gmail.com